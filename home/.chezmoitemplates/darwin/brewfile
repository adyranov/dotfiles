{{- $darwin := .darwin -}}
{{- $host := .host -}}

{{- $taps := list -}}
{{- $brews := splitList " " (includeTemplate "universal/packages" (dict "root" .)) }}
{{- $casks := list -}}
{{- $mas := list -}}

{{- with $darwin.common }}
  {{- $taps = concat $taps (index . "taps" | default list) -}}
  {{- $brews = concat $brews (index . "brews" | default list) -}}
  {{- $casks = concat $casks (index . "casks" | default list) -}}
  {{- $mas = concat $mas (index . "mas" | default list) -}}
{{- end }}

{{- if not $host.work }}
  {{- with $darwin.personal }}
    {{- $taps = concat $taps (index . "taps" | default list) -}}
    {{- $brews = concat $brews (index . "brews" | default list) -}}
    {{- $casks = concat $casks (index . "casks" | default list) -}}
    {{- $mas = concat $mas (index . "mas" | default list) -}}
  {{- end }}
{{- end }}

{{- if $host.work }}
  {{- with $darwin.work }}
    {{- $taps = concat $taps (index . "taps" | default list) -}}
    {{- $brews = concat $brews (index . "brews" | default list) -}}
    {{- $casks = concat $casks (index . "casks" | default list) -}}
    {{- $mas = concat $mas (index . "mas" | default list) -}}
  {{- end }}
{{- end }}

{{- range ($taps | sortAlpha | uniq) }}
tap "{{ . }}"
{{- end }}
{{ range ($brews | sortAlpha | uniq) }}
brew "{{ . }}"
{{- end }}
{{- if .host.interactive -}}
{{ range ($casks | sortAlpha | uniq) }}
cask "{{ . }}"
{{- end }}
{{ range ($mas | uniq) }}
mas "{{ .name }}", id: {{ .id }}
{{- end }}
{{- end }}
